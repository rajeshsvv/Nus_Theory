/**
	This file a minified version of livesearch2.js
**/
var LiveSearch=Class.create();LiveSearch.isIE=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));LiveSearch.prototype={initialize:function(name,mode,value,title,rootpath,hideClearButton,noShortList,peerShortList,callback){this.className=LiveSearch.isIE?"className":"class";this.name=name;this.searchMode=mode;this.title=title?title:"type some text to search for matching results";this.callback=callback;this.highlight='';this.noShortList=noShortList;this.peerShortList=peerShortList;this.liveSearchReq=false;this.t=null;this.liveSearchLast="";this.scopeLast=0;this.div=$("_div"+name);this.div.setAttribute(this.className,"LSContainer");if(!LiveSearch.isIE){this.div.style.position='relative';}
el=document.createElement("SPAN");el.setAttribute("id","_span"+name);el.setAttribute(this.className,"LSOuter");this.div.appendChild(el);this.scope_select=document.createElement('SELECT');this.scope_select.setAttribute("tabindex","2");this.scope_select.onchange=this.start.bindAsEventListener(this);this.scope_select.options[0]=new Option("Current Employees","3");this.scope_select.options[1]=new Option("Past Employees","2");this.scope_select.options[2]=new Option("All Employees","1");el.appendChild(this.scope_select);this.livesearch=document.createElement("INPUT");this.livesearch.setAttribute('type','text');this.livesearch.setAttribute('id',this.name);this.livesearch.setAttribute('name',this.name);this.livesearch.setAttribute('title',this.title);this.livesearch.setAttribute("autocomplete","off");this.livesearch.setAttribute('size','8');this.livesearch.onkeydown=this.navigate.bindAsEventListener(this);this.livesearch.onblur=this.hideDelayed.bindAsEventListener(this);this.livesearch.onkeyup=this.start.bindAsEventListener(this);this.livesearch.onfocus=this.show.bindAsEventListener(this);el.appendChild(this.livesearch);var img=document.createElement("IMG");img.style.padding="3px 3px 0";img.src=rootpath+"/images/emp.gif";el.appendChild(img);if(hideClearButton==0){img=document.createElement("IMG");img.src=rootpath+"/images/clear.gif";img.setAttribute("title","Clear currently selected employee");img.onclick=this.clearField.bindAsEventListener(this);el.appendChild(img);}
this.value=document.createElement("SPAN");this.value.id="_val"+this.name;if(LiveSearch.isIE){this.value[this.className]="ls_result";}else{this.value.setAttribute(this.className,"ls_result");}
this.value.innerHTML=value;el.appendChild(this.value);this.results=document.createElement("DIV");this.results.id="_res_"+this.name;if(LiveSearch.isIE){this.results[this.className]="LSResult";}else{this.results.setAttribute(this.className,"LSResult");}
this.div.appendChild(this.results);if(LiveSearch.isIE){var menu=this.shadow;var iframeEl=document.createElement("IFRAME");iframeEl.frameBorder=0;iframeEl.scrolling="no";iframeEl.id="LSIFrame_"+name;iframeEl.src="javascript:false;";iframeEl.style.display="none";iframeEl.style.position="absolute";iframeEl.style.border="solid thin red";iframeEl.style.filter="progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0)";this.div.appendChild(iframeEl);this.iFrame=iframeEl;}
this.shadow=document.createElement("UL");if(LiveSearch.isIE){this.shadow[this.className]="LSShadow";}else{this.shadow.setAttribute(this.className,"LSShadow");}
this.results.appendChild(this.shadow);this.results.style.left="0";this.gRef="_lsrch_"+this.name;eval(this.gRef+"=this")},hideDelayed:function(event){var dim=Element.getDimensions(this.results);if(Element.getStyle(this.results,'height')!=''){var x=999999;var y=999999;if(event){var x=event.x;var y=event.y;}
if(Position.within(this.results,x,y)){return;}}
window.setTimeout(this.gRef+".hide()",400);},hide:function(){this.results.style.zIndex=100;this.results.style.display="none";var highlight=this.highlight;if(highlight){highlight.removeAttribute(this.className);}
this.highlight=null;if(LiveSearch.isIE){this.iFrame.style.display="none";}},show:function(){var q=this.livesearch.value;if(q.length>0){this.results.style.display="block";}
if(LiveSearch.isIE){var top=this.scope_select.offsetHeight+5;var left=this.livesearch.offsetLeft-15;onode=this.div;x=''+top;prevnode=null;do{if(onode.offsetTop){top+=onode.offsetTop;}
x+=onode.tagName+"("+onode.className+")"+":"+onode.offsetTop+",";if(onode.offsetLeft){left+=onode.offsetLeft;}
prevnode=onode;onode=onode.offsetParent;}while(onode&&prevnode.tagName!='TABLE'&&onode.className!='content');this.results.style.top=top;this.results.style.left=left;this.iFrame.scrolling="no";Position.clone(this.results,this.iFrame,{setTop:(!this.results.style.height)});this.iFrame.style.zIndex=1;this.results.style.zIndex=2;Element.show(this.iFrame);}else{this.results.style.left=this.scope_select.offsetWidth+"px";}},start:function(event){if(event.keyCode==40||event.keyCode==38||event.keyCode==27||event.keyCode==13){return;}
if(this.t){window.clearTimeout(this.t);}
this.t=window.setTimeout(this.gRef+".search()",300);},search:function(){var q=this.livesearch.value;if(q==""){this.hide();return false;}
var index=this.scope_select.options.selectedIndex;var scope=this.scope_select.options[index].value;if(scope!=this.scopeLast||this.liveSearchLast!=q){empSearch.getEmployees(LiveSearch.updateResults,this.gRef,q,scope,this.searchMode,this.noShortList,this.peerShortList);}
this.liveSearchLast=q;this.scopeLast=scope;},setHighlightViaHover:function(event){var obj=Event.element(event);if(false&&obj){var li=obj.parentNode;this.setHighlight(li);}},setHighlight:function(li){if(li){if(this.highlight){this.highlight.removeAttribute(this.className);}
this.highlight=li;if(LiveSearch.isIE){this.highlight[this.className]="current";}else{this.highlight.setAttribute(this.className,"current");}
li.scrollIntoView(false);}},chooseItemByMouse:function(event){var el=Event.element(event);this.chooseItem(el.parentNode)},chooseItem:function(li){var desc=li.firstChild.innerHTML;var id=li.id.substr(7);this.value.innerHTML=desc;this.hide();if(this.callback){this.callback(id,desc);}},clearField:function(){this.value.innerHTML="";if(this.callback){this.callback(-1,"");}},navigate:function(event){if(this.results.childNodes.length==0){return;}
var li=this.highlight;if(event.keyCode==Event.KEY_DOWN)
{if(!li){li=this.ul.firstChild;}else{li=this.highlight.nextSibling;}
this.setHighlight(li);}
else if(event.keyCode==Event.KEY_UP){if(!li){this.show();li=this.ul.lastChild;}
else{li=this.highlight.previousSibling;}
this.setHighlight(li);}
else if(event.keyCode==Event.KEY_ESC){li=null;this.hide();}
else if(event.keyCode==Event.KEY_RETURN){if(!this.highlight&&this.results.childNodes.length==1){this.highlight=this.ul.firstChild;}
if(this.highlight){this.chooseItem(this.highlight);}}
else if(event.keyCode==Event.KEY_BACKSPACE){this.liveSearchLast=null;return;}else{return;}
event.cancelBubble=true;event.returnValue=false;if(!LiveSearch.isIE){event.preventDefault();}
if(event.stopPropagation)event.stopPropagation();}}
LiveSearch.updateResults=function(employees){if(employees==null||employees.length==0){return;}
var searcher=eval(employees[0]);var sh=document.createElement('UL');searcher.ul=sh;for(var j=1;j<employees.length&&j<500;j++){var emp=employees[j];var id="_ls_li_"+emp.id;var name=emp.name+' ['+emp.employeeNo+']';var li=document.createElement("LI");li.setAttribute('id',id);sh.appendChild(li);aEl=document.createElement('A');aEl.innerHTML=name;aEl.setAttribute('id','_ls_link_'+id);aEl.onmouseover=searcher.setHighlightViaHover.bindAsEventListener(searcher);aEl.onclick=searcher.chooseItemByMouse.bindAsEventListener(searcher);li.appendChild(aEl);}
if(sh.childNodes.length>0){while(searcher.results.childNodes.length>0){var child=searcher.results.childNodes[0];searcher.results.removeChild(child);}
searcher.shadow=sh;searcher.results.appendChild(sh);sh.highlight=null;searcher.show();}else{searcher.innerHTML="";searcher.hide();}}